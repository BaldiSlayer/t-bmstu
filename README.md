# t-bmstu

Это агрегатор тестирующих систем.
Пока что планируется добавить следующие тестирующие системы:
* [codeforces](https://codeforces.com/)
* [Timus](https://acm.timus.ru)

В дальнейшем данный проект может использоваться для проведения тренировок по спортивному программированию или для выдачи индивидуального задания.

TODO дописать..

# Список участников

1. [Алексей Лисов](https://gitflic.ru/user/lisov-a2005)
2. Егор Домаскин ??

# Как это поднять?
Проект можно запустить с помощью `Makefile` командой `make run`. 
Или же просто запустить `/cmd/main.go` (это запустит сервер). 
И запустить `/workers/timus/timus.py` (воркер тимуса)
### Что нужно для запуска?
1) Для начала надо установить нужные библиотеки, например `Gin` 
(фреймворк для бэкенда) и `github.com/PuerkitoBio/goquery` (библиотека для парсинга),
`github.com/spf13/viper` (библиотека для парсинга yaml). 
Полный список не приложу. Также нужно установить нужные библиотеки для 
воркера тимус.
2) Создать файл `/configs/config.yaml`. В нем должны быть следующие
Переменные
```yaml
port: "порт на котором будет запущено приложение"
DBUsername: "Имя пользователя для базы данных"
DBPassword: "Пароль для базы данных"
DBName: "Имя базы данных"
SessionSecret: "Секрет для генерации сессий"
```
Примечание: порт лучше оставить 8080, потому что на него
настроена моя аутентификация через `github`.
3) Нужна база данных `PostgreSQL`

### Что за странные id задач?
На самом деле id задачи это просто: `название тест системы` + 
`id задачи в этой системе` и эта строка была закодирована в `base64`

### Как присоединить новую тестирующую систему?
`/pkg/testsystems/testsystems.go` - почитать комменты там

`/worker/timus/timus.py` - это воркер, который работает отдельно.
Он занимается отправкой задач и обновлением вердиктов задач. 
И записью всего этого в базу данных. Грубо говоря таблица `submissions` -
это очередь неотправленных посылок. Также есть таблица непроверенных посылок.
И есть собственно таблица с текущими вердиктами посылок.

То есть для того, чтобы добавить новую тестирующую систему, необходимо:
1) Создать наследник ИнТеРфЕйСа `TestSystem`
2) Добавить тестирующую систему в `AllowedTestsystems`
3) Сделать воркер

Вообще нужно бы подумать, как сделать так, чтобы воркеры были 
однотипные, может объединить все в один?